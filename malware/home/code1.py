import pandas as pd
from sklearn.model_selection import train_test_split
from sklearn.ensemble import RandomForestClassifier
from sklearn.neighbors import KNeighborsClassifier
from sklearn.linear_model import LinearRegression
from sklearn.svm import SVC
from sklearn.metrics import accuracy_score
import pickle
from sklearn.linear_model import LinearRegression

data=pd.read_csv("Malware122.csv")
X=data[["Querylength","domain_token_count","path_token_count","avgdomaintokenlen","longdomaintokenlen","avgpathtokenlen","charcompvowels","charcompace","urlLen","domainlength","pathLength","subDirLen","fileNameLen","this.fileExtLen","ArgLen"]]
Y=data.Type

#Split data into training and testing sets
x_train, x_test, y_train, y_test = train_test_split(X, Y, test_size=0.2)

# Define and train the models
models = {
    "Random Forest": RandomForestClassifier(),
    "KNN": KNeighborsClassifier(),
    "SVM": SVC()
}

for name, model in models.items():
    model.fit(x_train, y_train)
    predictions = model.predict(x_test)
    accuracy = accuracy_score(y_test, predictions)
    print(f"{name} accuracy: {accuracy:.4f}")

# Create a linear regression model
# model1 = RandomForestClassifier()
model1=LinearRegression()
model1.fit(x_train, y_train)

# Save the model to a pickle file
with open('model.pkl', 'wb') as file:
    pickle.dump(model1, file)

