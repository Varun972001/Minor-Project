from django.shortcuts import render
from django.http import JsonResponse
from .web1 import extract_features
import pandas as pd
import pickle
import json

# Your other views here...
def index(request):
    return render(request,"home_temp/index.html")

# Define a Django view to handle form submission
def analyze_url(request):
    if request.method == "POST":
        url = request.POST.get("url", "")
        if url:
            data = extract_features(url)
            with open('home/model.pkl', 'rb') as file:
                model1 = pickle.load(file)
            index=[0]
            data=pd.DataFrame(data,index=index)
            prediction = model1.predict(data)
            if prediction > -0.2:
                result = "The URL Is Not A Malware."
            else:
                result = "The URL Is A Malware."
            return render(request,"home_temp/result.html",{"answer":result})
        else:
            return JsonResponse({"error": "Invalid URL data"})
    else:
        return JsonResponse({"error": "Invalid request method"})

